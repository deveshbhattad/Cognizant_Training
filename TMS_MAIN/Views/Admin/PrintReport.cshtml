@model TMS_MAIN.ViewModels.ReportDisplayViewModel
@{
    Layout = null;
    ViewData["Title"] = "Print Report - " + Model.Report.ReportName;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"]</title>
    <style>
        /* Keep all the existing print styles */
        /* Add this for better table printing */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .badge {
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }

        .badge-success {
            background-color: #d4edda;
            color: #155724;
        }

        .badge-danger {
            background-color: #f8d7da;
            color: #721c24;
        }

        .badge-warning {
            background-color: #fff3cd;
            color: #856404;
        }

        .badge-info {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        .text-success {
            color: #155724;
        }

        .text-danger {
            color: #721c24;
        }
    </style>
</head>
<body>
    <div style="text-align: center; margin-bottom: 20px;">
        <h2>@Model.Report.ReportName</h2>
        <h4>@Model.Report.Module Report</h4>
        <p>
            Generated on: @Model.Report.GeneratedDate.ToString("g") |
            Date Range: @Model.Report.StartDate.ToShortDateString() - @Model.Report.EndDate.ToShortDateString() |
            Status: @Model.Report.Status
        </p>
    </div>

    @if (Model.Report.Module == "CashFlow")
    {
        var reportData = Model.ReportData as TMS_MAIN.Models.CashFlowReportViewModel;
        <partial name="~/Views/Reports/_CashFlowReport.cshtml" model="reportData" />
    }
    else if (Model.Report.Module == "Investment")
    {
        var reportData = Model.ReportData as TMS_MAIN.ViewModels.PortfolioSummaryViewModel;
        <partial name="~/Views/Reports/_InvestmentReport.cshtml" model="reportData" />
    }
    else if (Model.Report.Module == "Risk")
    {
        var reportData = Model.ReportData as TMS_MAIN.Models.RiskReportViewModel;
        <partial name="~/Views/Reports/_RiskReport.cshtml" model="reportData" />
    }
    else if (Model.Report.Module == "BankAccount")
    {
        var reportData = Model.ReportData as TMS_MAIN.ViewModels.BankAccountReportViewModel;
        <partial name="~/Views/Reports/_BankAccountReport.cshtml" model="reportData" />
    }

    @if (Model.Compliances.Any())
    {
        <h3>Compliance Details</h3>
        <table>
            <thead>
                <tr>
                    <th>Submitted By</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var compliance in Model.Compliances)
                {
                    <tr>
                        <td>@compliance.User?.FullName</td>
                        <td>@compliance.SubmissionDate.ToString("g")</td>
                        <td>
                            <span class="badge badge-success">@compliance.Status</span>
                        </td>
                        <td>@compliance.Notes</td>
                    </tr>
                }
            </tbody>
        </table>
    }

    <div style="page-break-after: always;"></div>

    <div class="no-print" style="margin-top: 20px; text-align: center;">

        <button onclick="window.close()" style="padding: 8px 16px; background-color: #6c757d; color: white; border: none; cursor: pointer; margin-left: 10px;">
            Close
        </button>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 200);
        };
    </script>
</body>
</html>